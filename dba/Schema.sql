CREATE TABLE  BaseDados(
    id_bd number(30) NOT NULL,
    id_db_root number(30) NOT NULL,
    name varchar(200) NOT NULL,
    platform varchar(20) NOT NULL,
    TIMESTAMP DATE NOT NULL,
    CONSTRAINT id_bd PRIMARY KEY (id_bd)
    );
    
-- TABLESPACE
    
    CREATE TABLE TABLESPACES 
(
  NAME_TS VARCHAR2(200) NOT NULL 
, TOTAL_SIZE NUMBER(20) NOT NULL  
, FREE_SIZE NUMBER(20) NOT NULL
, ID_BD NUMBER(30) NOT NULL 
, TIMESTAMP DATE NOT NULL 
, CONSTRAINT TABLESPACES_PK PRIMARY KEY 
  (
    NAME_TS 
  )
  ENABLE 
);

ALTER TABLE TABLESPACES
ADD CONSTRAINT TABLESPACES_FK1 FOREIGN KEY
(
  ID_BD 
)
REFERENCES BASEDADOS
(
  ID_BD 
)
ENABLE;


-- DATAFILE

CREATE TABLE DATAFILES 
(
  ID_DF NUMBER(30) NOT NULL 
, NAME VARCHAR2(20) NOT NULL 
, TOTAL_SIZE NUMBER(30) NOT NULL 
, FREE_SIZE NUMBER(30) NOT NULL
, NAME_TS VARCHAR2(200) NOT NULL 
, TIMESTAMP DATE NOT NULL 
, CONSTRAINT DATAFILES_PK PRIMARY KEY 
  (
    ID_DF 
  )
  ENABLE 
);

ALTER TABLE DATAFILES
ADD CONSTRAINT DATAFILES_FK1 FOREIGN KEY
(
  NAME_TS 
)
REFERENCES TABLESPACES
(
  NAME_TS 
)
ENABLE;

DROP TABLE DATAFILES;

--CPU

CREATE TABLE CPU 
(
  ID_C NUMBER(30, 0) NOT NULL 
, USAGE NUMBER(20, 0) NOT NULL 
, TOTAL NUMBER(20, 0) NOT NULL 
, TIMESTAMP DATE NOT NULL 
, ID_BD NUMBER(20, 0) NOT NULL 
, CONSTRAINT CPU_PK PRIMARY KEY 
  (
    ID_C 
  )ENABLE 
  );


ALTER TABLE CPU
ADD CONSTRAINT CPU_FK1 FOREIGN KEY
(
  ID_BD 
)
REFERENCES BASEDADOS
(
  ID_BD 
)
ENABLE;


--Memory

CREATE TABLE MEMORY 
(
  ID_M NUMBER(30) NOT NULL 
, TOTAL NUMBER(30) NOT NULL 
, USAGE NUMBER(30) NOT NULL 
, TIMESTAMP DATE NOT NULL 
, ID_BD NUMBER(30) NOT NULL 
, CONSTRAINT MEMORY_PK PRIMARY KEY 
  (
    ID_M 
  )
  ENABLE 
);

ALTER TABLE MEMORY
ADD CONSTRAINT MEMORY_FK1 FOREIGN KEY
(
  ID_BD 
)
REFERENCES BASEDADOS
(
  ID_BD 
)
ENABLE;

--Users

CREATE TABLE USERS 
(
  ID_USER NUMBER(20) NOT NULL 
, USERNAME VARCHAR2(70) NOT NULL 
, LAST_LOGIN DATE NOT NULL 
, ATIVO NUMBER(1) NOT NULL 
, TIMESTAMP DATE NOT NULL 
, ID_BD NUMBER NOT NULL 
, NAME_TS VARCHAR(200) NOT NULL
, CONSTRAINT USERS_PK PRIMARY KEY 
  (
    ID_USER 
  )
  ENABLE 
);

ALTER TABLE USERS
ADD CONSTRAINT USERS_FK1 FOREIGN KEY
(
  ID_BD 
)
REFERENCES BASEDADOS
(
  ID_BD 
)
ENABLE;

ALTER TABLE USERS
ADD CONSTRAINT USERS_FK2 FOREIGN KEY
(
  NAME_TS
)
REFERENCES TABLESPACES
(
  NAME_TS
)
ENABLE;

--ROLES
CREATE TABLE ROLES 
(
  ID_ROLES NUMBER(30) NOT NULL 
, NAME VARCHAR2(20) NOT NULL 
, TIMESTAMP DATE NOT NULL 
, CONSTRAINT ROLES_PK PRIMARY KEY 
  (
    ID_ROLES 
  )
  ENABLE 
);

DROP TABLE ROLES;

--ROLES USERS

CREATE TABLE USERROLES 
(
  ID_USER NUMBER NOT NULL 
, ID_ROLES NUMBER NOT NULL 
, TIMESTAMP DATE NOT NULL 
, CONSTRAINT USERROLES_PK PRIMARY KEY 
  (
    ID_USER 
  , ID_ROLES 
  )
  ENABLE 
);

ALTER TABLE USERROLES
ADD CONSTRAINT USERROLES_FK1 FOREIGN KEY
(
  ID_ROLES 
)
REFERENCES ROLES
(
  ID_ROLES 
)
ENABLE;

ALTER TABLE USERROLES
ADD CONSTRAINT USERROLES_FK2 FOREIGN KEY
(
  ID_USER 
)
REFERENCES USERS
(
  ID_USER 
)
ENABLE;


-- USERS_PRIVILEGES

CREATE TABLE USERS_PRIVILEGES 
(
  ID_PRIV NUMBER NOT NULL 
, NAME VARCHAR2(20) NOT NULL 
, TIMESTAMP DATE NOT NULL 
, CONSTRAINT USERS_PRIVILEGES_PK PRIMARY KEY 
  (
    ID_PRIV 
  )
  ENABLE 
);


-- USERS_PRIVILEGESUSERS

CREATE TABLE USERS_PRIVILEGESUSERS 
(
  ID_USER NUMBER NOT NULL 
, ID_PRIV NUMBER NOT NULL 
, TIMESTAMP DATE NOT NULL 
, CONSTRAINT USERS_PRIVILEGESUSERS_PK PRIMARY KEY 
  (
    ID_USER 
  , ID_PRIV 
  )
  ENABLE 
);

ALTER TABLE USERS_PRIVILEGESUSERS
ADD CONSTRAINT USERS_PRIVILEGESUSERS_FK1 FOREIGN KEY
(
  ID_USER 
)
REFERENCES USERS
(
  ID_USER 
)
ENABLE;

ALTER TABLE USERS_PRIVILEGESUSERS
ADD CONSTRAINT USERS_PRIVILEGESUSERS_FK2 FOREIGN KEY
(
  ID_PRIV 
)
REFERENCES USERS_PRIVILEGES
(
  ID_PRIV 
)
ENABLE;

--SESSIONS

CREATE TABLE SESSIONS 
(
  ID_SES NUMBER(20) NOT NULL 
, PROGRAM VARCHAR2(20) NOT NULL 
, TIMESTAMP DATE NOT NULL 
, ID_USER NUMBER NOT NULL 
, CONSTRAINT SESSIONS_PK PRIMARY KEY 
  (
    ID_SES 
  )
  ENABLE 
);

ALTER TABLE SESSIONS
ADD CONSTRAINT SESSIONS_FK1 FOREIGN KEY
(
  ID_USER 
)
REFERENCES USERS
(
  ID_USER 
)
ENABLE;





